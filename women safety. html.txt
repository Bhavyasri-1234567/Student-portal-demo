<!DOCTYPE html>


// Normalize
risk = clamp(Math.round(risk), 0, 100);


return { risk, inputs: {time, day, lighting, crowd, police, reports, transport, company, familiarity, shareLive} };
}


function statusFor(score){
if (score <= 33) return {label: 'Lower risk', cls: 'ok'};
if (score <= 66) return {label: 'Moderate', cls: 'warn'};
return {label: 'Higher risk', cls: 'danger'};
}


function tipsFor(ctx){
const t = [];
const {time, day, lighting, crowd, police, reports, transport, company, familiarity, shareLive} = ctx.inputs;


if (time === 'night' || time === 'early') t.push('Prefer well‑lit, busier roads at late hours; avoid isolated shortcuts.');
if (lighting <= 4) t.push('Choose routes with better street lighting; carry a small torch on your phone.');
if (police <= 3) t.push('Note nearest open shops, kiosks, or security posts as safe points.');
if (transport === 'none') t.push('Identify nearest cab stand/metro before starting; arrange pickup if possible.');
if (company === 'alone') t.push('Share trip details with a trusted contact; set check‑ins.');
if (familiarity <= 3) t.push('Preview your route on a map and mark landmarks to avoid stops for directions.');
if (reports >= 3) t.push('Recent incidents reported. Consider alternate time/route or travel with company.');
if (crowd <= 2) t.push('Area seems isolated. Stick to main roads or wait for company.');
if (crowd >= 9) t.push('Very crowded zone—secure belongings and plan exits.');
if (shareLive === 'no') t.push('Enable live location sharing or SOS shortcuts on your phone.');
if (t.length === 0) t.push('Keep general precautions: stay aware, keep phone charged, and trust your instincts.');
return t;
}


function render(){
const ctx = computeScore();
const { risk } = ctx;
const s = statusFor(risk);


gauge.style.setProperty('--val', risk);
gauge.setAttribute('data-label', ${risk});
statusPill.textContent = Status: ${s.label};
statusPill.className = pill ${s.cls};
scoreNote.textContent = risk <= 33 ? 'Area appears relatively lower risk. Stay aware and use standard precautions.'
: risk <= 66 ? 'Mixed signals. Apply extra caution and consider route/time alternatives.'
: 'Context suggests higher risk. If possible, choose a safer route or travel with company.';


// Tips
tipsList.innerHTML = '';
tipsFor(ctx).forEach(t => {
const li = document.createElement('li');
li.textContent = t;
tipsList.appendChild(li);
});
}


document.getElementById('predictBtn').addEventListener('click', render);
document.getElementById('resetBtn').addEventListener('click', () => {
document.getElementById('location').value = '';
document.getElementById('time').value = 'day';
document.getElementById('day').value = 'weekday';
document.getElementById('lighting').value = 6; document.getElementById('lightingVal').textContent = '6 / 10';
document.getElementById('crowd').value = 5; document.getElementById('crowdVal').textContent = '5 / 10';
document.getElementById('police').value = 3; document.getElementById('policeVal').textContent = '3 / 10';
document.getElementById('reports').value = 0;
document.getElementById('transport').value = 'none';
document.getElementById('company').value = 'alone';
document.getElementById('familiarity').value = 4; document.getElementById('familiarityVal').textContent = '4 / 10';
document.getElementById('shareLive').value = 'no';
gauge.style.setProperty('--val', 0);
gauge.setAttribute('data-label', '—');
statusPill.textContent = 'Status: —';
statusPill.className = 'pill';
scoreNote.textContent = 'Click Predict to compute a score.';
tipsList.innerHTML = '';
});


// Auto-run once for initial preview
render();
</script>
</body>
</html>